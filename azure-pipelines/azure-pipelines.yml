trigger:
  - none

pool:
  vmImage: ubuntu-latest

steps:
  - task: Docker@2
    inputs:
      containerRegistry: 'anymodconrst001dg'
      repository: 'renovate'
      command: 'build'
      Dockerfile: 'Dockerfile'

  - task: Docker@2
    inputs:
      containerRegistry: 'anymodconrst001dg'
      repository: 'renovate'
      command: 'push'
      Dockerfile: 'Dockerfile'
      tags: |
        $(Build.BuildId)
        latest
    condition: and(succeeded(), ne(variables['Build.Reason'], 'PullRequest'), eq(variables['Build.SourceBranch'], 'refs/heads/main'))
